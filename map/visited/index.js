import * as echarts from 'https://cdn.jsdelivr.net/npm/echarts@5.6.0/dist/echarts.esm.min.js'
const urlParams = new URLSearchParams(window.location.search);
const cityDir = urlParams.get('cityDir') ?? 'city'; // Can be eiher 'city' or 'county'
const mapName = '中国大陆';
const geojson = await fetch(`../echarts-china-cities-js/geojson/${cityDir === 'city' ? 'shape-only' : 'shape-with-internal-borders'}/map.geojson`).then(res => res.json());
echarts.registerMap(mapName, geojson);
const cityArr = geojson.features.map(feature => feature.properties.name);
const visitedArr = cityDir === 'city' ? [
	'香港', '澳门',
	'广州', '深圳', '珠海', '汕头', '佛山', '韶关', '湛江', '肇庆', '江门', '茂名', '惠州', '汕尾', '河源', '阳江', '清远', '东莞', '中山', '潮州', '揭阳', '云浮', // '梅州',
	'南宁', '桂林', '梧州', '贵港', '贺州', '来宾', // '柳州', '北海', '防城港', '钦州', '玉林', '百色', '河池', '崇左',
	'长沙', '株洲', '衡阳', // '湘潭', '邵阳', '岳阳', '常德', '张家界', '益阳', '郴州', '永州', '怀化', '娄底', '湘西',
	'九江', // '南昌', '赣州', '宜春', '吉安', '上饶', '抚州', '景德镇', '萍乡', '新余', '鹰潭',
	'漳州', '厦门', // '福州', '泉州', '龙岩', '三明', '南平', '莆田', '宁德',
	'海口', '文昌', '琼海', '万宁', '陵水', '三亚', '保亭', '东方', '儋州', // '三沙', '五指山', '定安', '屯昌', '澄迈', '临高', '白沙', '昌江', '乐东', '琼中',
	'贵阳', '六盘水', '遵义', '安顺', '黔西南', '黔南', '黔东南', // '毕节', '铜仁',
	'昆明', '文山', '丽江', '迪庆', '大理', // '曲靖', '玉溪', '保山', '昭通', '普洱', '临沧', '楚雄', '红河', '西双版纳', '德宏', '怒江',
	'重庆',
	'成都', '阿坝', '内江', '资阳', '眉山', '乐山', '宜宾', '泸州', // '绵阳', '广元', '德阳', '南充', '广安', '遂宁', '自贡', '攀枝花', '巴中', '达州', '雅安', '甘孜', '凉山',
	'武汉', // '黄石', '襄阳', '荆州', '宜昌', '十堰', '孝感', '荆门', '鄂州', '黄冈', '咸宁', '随州', '恩施', '仙桃', '潜江', '天门', '神农架',
	'宁波', '舟山', // '杭州', '宁波', '温州', '嘉兴', '湖州', '绍兴', '金华', '衢州', '舟山', '台州', '丽水',
	'上海',
	'南京', // '无锡', '徐州', '常州', '苏州', '南通', '连云港', '淮安', '盐城', '扬州', '镇江', '泰州', '宿迁',
	'济南', '泰安', '烟台', '青岛', // '淄博', '枣庄', '东营', '潍坊', '济宁', '威海', '日照', '临沂', '德州', '聊城', '滨州', '菏泽',
	'北京',
	'日喀则', '拉萨', '山南', '林芝', // '昌都', '那曲', '阿里',
	'哈尔滨',
] : [
	'香港香港', '澳门澳门',
	'广州越秀', '广州海珠', '广州荔湾', '广州天河', '广州白云', '广州黄埔', '广州花都', '广州番禺', '广州南沙', '广州增城', '广州从化',
	'深圳福田', '深圳罗湖', '深圳盐田', '深圳南山', '深圳宝安', '深圳龙岗', '深圳龙华', '深圳坪山', // '深圳光明',
	'珠海香洲', '珠海金湾', '珠海斗门', '汕头金平', '汕头龙湖',
	'汕头濠江', '汕头潮阳', '汕头南澳', // '汕头潮南', '汕头澄海',
	'佛山禅城', '佛山南海', '佛山顺德', '佛山高明', '佛山三水',
	'韶关浈江', '韶关武江', '韶关曲江', '韶关仁化', // '韶关乐昌', '韶关南雄', '韶关始兴', '韶关翁源', '韶关新丰', '韶关乳源',
	'湛江赤坎', '湛江霞山', '湛江麻章', // '湛江坡头', '湛江雷州', '湛江廉江', '湛江吴川', '湛江遂溪', '湛江徐闻',
	'肇庆端州', '肇庆鼎湖', '肇庆高要', '肇庆广宁', '肇庆德庆', '肇庆封开', '肇庆怀集', '肇庆四会',
	'江门蓬江', '江门江海', '江门新会', '江门台山', '江门开平', '江门鹤山', '江门恩平',
	'茂名茂南', '茂名电白', '茂名化州', // '茂名信宜', '茂名高州',
	'惠州惠城', '惠州惠阳', '惠州惠东', '惠州博罗', // '惠州龙门',
	'汕尾城区', '汕尾陆丰', '汕尾海丰', // '汕尾陆河',
	'河源源城', // '河源东源', '河源和平', '河源龙川', '河源紫金', '河源连平',
	'阳江江城', // '阳江阳东', '阳江阳春', '阳江阳西',
	'清远清城', '清远清新', '清远英德', // '清远连州', '清远佛冈', '清远阳山', '清远连山', '清远连南',
	'东莞东莞', 
	'中山中山',
	'潮州湘桥', '潮州潮安', // '潮州饶平',
	'揭阳榕城', '揭阳揭东', // '揭阳普宁', '揭阳揭西', '揭阳惠来',
	'云浮云城', '云浮云安', '云浮罗定', '云浮新兴', '云浮郁南',
	'南宁青秀', '南宁兴宁', '南宁西乡塘',
	'桂林秀峰', '桂林叠彩', '桂林象山', '桂林七星', '桂林龙胜', '桂林灵川', '桂林阳朔', '桂林恭城',
	'梧州万秀', '梧州长洲', '梧州龙圩', '梧州藤县', '梧州岑溪',
	'贵港港北', '贵港桂平', '贵港平南',
	'贺州八步', '贺州平桂',
	'来宾兴宾',
	'长沙芙蓉', '长沙天心', '长沙岳麓', '长沙开福', '长沙雨花',
	'株洲荷塘', '株洲芦淞', '株洲天元',
	'衡阳南岳',
	'九江柴桑', '九江庐山',
	'漳州云霄', '漳州东山',
	'厦门思明', '厦门湖里', '厦门集美',
	'海口秀英', '海口龙华', '海口琼山', '海口美兰',
	'文昌文昌',
	'琼海琼海',
	'万宁万宁',
	'陵水陵水',
	'三亚海棠', '三亚吉阳', '三亚天涯', '三亚崖州',
	'保亭保亭',
	'东方东方',
	'儋州儋州',
	'贵阳南明', '贵阳花溪', '贵阳云岩', '贵阳白云',
	'六盘水钟山', '六盘水水城',
	'遵义红花岗', '遵义汇川',
	'安顺西秀',
	'黔西南兴义',
	'黔南都匀', '黔南三都',
	'黔东南黎平', '黔东南榕江',
	'昆明盘龙', '昆明西山', '昆明官渡', '昆明呈贡', '昆明石林', '昆明东川',
	'文山丘北',
	'丽江古城', '丽江玉龙',
	'迪庆香格里拉',
	'大理大理',
	'重庆渝中', '重庆江北', '重庆沙坪坝', '重庆九龙坡', '重庆南岸', '重庆北碚', '重庆渝北', '重庆綦江', '重庆大足', '重庆璧山', '重庆武隆',
	'成都锦江', '成都青羊', '成都武侯', '成都成华', '成都双流', '成都简阳', '成都都江堰',
	'阿坝九寨沟',
	'内江市中', '内江东兴',
	'资阳雁江',
	'眉山东坡',
	'乐山市中', '乐山峨眉山',
	'宜宾翠屏', '宜宾叙州',
	'泸州江阳', '泸州龙马潭',
	'武汉硚口', '武汉武昌', '武汉洪山',
	'宁波海曙', '宁波江北', '宁波镇海',
	'舟山定海', '舟山普陀',
	'上海长宁', '上海黄浦', '上海浦东',
	'南京栖霞', '南京玄武', '南京江宁', '南京秦淮', 
];
visitedArr.forEach(visited => {
	if (!cityArr.includes(visited)) console.log(`The visited city ${visited} does not exist in the geojson.`);
});
echarts.init(document.getElementById('mainChart'), 'dark').setOption({
	visualMap: {
		min: 0,
		max: 1,
		text: ['去过', '没去过'],
		calculable: true,
		inRange: {
			color: ['green', 'orangered']
		},
		left: '40%',
	},
	series: {
		type: 'map',
		map: mapName, // Map name registered in echarts.registerMap().
		roam: true,
		zoom: 1.2,
		label: {
			show: cityDir === 'city',
			color: 'white',
//			fontSize: 7, // Default is 12
		},
		data: cityArr.map(city => ({
			name: city,
			value: +visitedArr.includes(city),
		})),
	},
});
